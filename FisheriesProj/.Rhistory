ifelse(area=='KLM', "Lower Columbia River",
ifelse(area=='HAN', "Upper Columbia River",
ifelse(area=='HAR', "Snake River",
ifelse(area=='HOK', "North Oregon Coast",
ifelse(area=='KLM', "Mid Oregon Coast",1)))))))))))))))))))
Indicator_ID%>%mutate(stock_name=ifelse(area=='NSA'|'SSA'|'CHK'|'UNU', "Southeast Alaska",
ifelse(area=='TST', "Transboundary Rivers",
ifelse(area=='KLM', "North/Central BC",
ifelse(area=='COW', "WCVI",
ifelse(area=='CWF', "Strait of Georgia",
ifelse(area=='ELK', "Fraser River",
ifelse(area=='ELW', "North Puget Sound",
ifelse(area=='GAD', "Central Puget Sound",
ifelse(area=='GRN', "South Puget Sound",
ifelse(area=='HAN', "Hood Canal",
ifelse(area=='HAR', "Juan de Fuca",
ifelse(area=='HOK', "North Washington Coast",
ifelse(area=='KLM', "Lower Columbia River",
ifelse(area=='HAN', "Upper Columbia River",
ifelse(area=='HAR', "Snake River",
ifelse(area=='HOK', "North Oregon Coast",
ifelse(area=='KLM', "Mid Oregon Coast",1))))))))))))))))))
Indicator_ID%>%mutate(area=ifelse(stock_code=='NSA'|'SSA'|'CHK'|'UNU', "Southeast Alaska",
ifelse(stock_code=='TST', "Transboundary Rivers",
ifelse(stock_code=='KLM', "North/Central BC",
ifelse(stock_code=='COW', "WCVI",
ifelse(stock_code=='CWF', "Strait of Georgia",
ifelse(stock_code=='ELK', "Fraser River",
ifelse(stock_code=='ELW', "North Puget Sound",
ifelse(stock_code=='GAD', "Central Puget Sound",
ifelse(stock_code=='GRN', "South Puget Sound",
ifelse(stock_code=='HAN', "Hood Canal",
ifelse(stock_code=='HAR', "Juan de Fuca",
ifelse(stock_code=='HOK', "North Washington Coast",
ifelse(stock_code=='KLM', "Lower Columbia River",
ifelse(stock_code=='HAN', "Upper Columbia River",
ifelse(stock_code=='HAR', "Snake River",
ifelse(stock_code=='HOK', "North Oregon Coast",
ifelse(stock_code=='KLM', "Mid Oregon Coast",1))))))))))))))))))
Indicator_ID%>%mutate(area=ifelse(stock_code=='NSA'|stock_code=='SSA'|stock_code=='CHK'|stock_code=='UNU', "Southeast Alaska",
ifelse(stock_code=='TST', "Transboundary Rivers",
ifelse(stock_code=='KLM', "North/Central BC",
ifelse(stock_code=='COW', "WCVI",
ifelse(stock_code=='CWF', "Strait of Georgia",
ifelse(stock_code=='ELK', "Fraser River",
ifelse(stock_code=='ELW', "North Puget Sound",
ifelse(stock_code=='GAD', "Central Puget Sound",
ifelse(stock_code=='GRN', "South Puget Sound",
ifelse(stock_code=='HAN', "Hood Canal",
ifelse(stock_code=='HAR', "Juan de Fuca",
ifelse(stock_code=='HOK', "North Washington Coast",
ifelse(stock_code=='KLM', "Lower Columbia River",
ifelse(stock_code=='HAN', "Upper Columbia River",
ifelse(stock_code=='HAR', "Snake River",
ifelse(stock_code=='HOK', "North Oregon Coast",
ifelse(stock_code=='KLM', "Mid Oregon Coast",1))))))))))))))))))
Indicator_ID%>%mutate(area=ifelse(stock_code=='NSA'|stock_code=='SSA'|stock_code=='CHK'|stock_code=='UNU', "Southeast Alaska",
ifelse(stock_code=='TST', "Transboundary Rivers",
ifelse(stock_code=='ATM'|stock_code=='KLM', "North/Central BC",
ifelse(stock_code=='RBT', "WCVI",
ifelse(stock_code=='QUI'|stock_code=='PHI'|stock_code=='PPS'|stock_code=='BQR'|stock_code=='COW', "Strait of Georgia",
ifelse(stock_code=='HAR'|stock_code=='CHI'|stock_code=='CKO'|stock_code=='NIC'|stock_code=='SHU'|stock_code=='MSH', "Fraser River",
ifelse(stock_code=='NSF'|stock_code=='SAM'|stock_code=='SSF'|stock_code=='SKF', "North Puget Sound",
ifelse(stock_code=='STL'|stock_code=='SKY', "Central Puget Sound",
ifelse(stock_code=='NIS'|stock_code=='SPS', "South Puget Sound",
ifelse(stock_code=='GAD', "Hood Canal",
ifelse(stock_code=='ELW', "Juan de Fuca",
ifelse(stock_code=='HOK'|stock_code=='QUE'|stock_code=='SOO', "North Washington Coast",
ifelse(stock_code=='LRH'|stock_code=='CWF'|stock_code=='LRW'|stock_code=='WSH'|stock_code=='SPR', "Lower Columbia River",
ifelse(stock_code=='HAN'|stock_code=='SMK'|stock_code=='SUM'|stock_code=='URB', "Upper Columbia River",
ifelse(stock_code=='LYF'|stock_code=='LYY', "Snake River",
ifelse(stock_code=='SRH', "North Oregon Coast",
ifelse(stock_code=='ELK', "Mid Oregon Coast",1))))))))))))))))))
Indicator_ID%>%mutate(area=ifelse(stock_code=='NSA'|stock_code=='SSA'|stock_code=='CHK'|stock_code=='UNU', "Southeast Alaska",
ifelse(stock_code=='TST', "Transboundary Rivers",
ifelse(stock_code=='ATN'|stock_code=='KLM'|stock_code=='KLY', "North/Central BC",
ifelse(stock_code=='RBT', "WCVI",
ifelse(stock_code=='QUI'|stock_code=='PHI'|stock_code=='PPS'|stock_code=='BQR'|stock_code=='COW', "Strait of Georgia",
ifelse(stock_code=='HAR'|stock_code=='CHI'|stock_code=='CKO'|stock_code=='NIC'|stock_code=='SHU'|stock_code=='MSH', "Fraser River",
ifelse(stock_code=='NSF'|stock_code=='SAM'|stock_code=='SSF'|stock_code=='SKF', "North Puget Sound",
ifelse(stock_code=='STL'|stock_code=='SKY', "Central Puget Sound",
ifelse(stock_code=='NIS'|stock_code=='SPS'|stock_code=='GRN', "South Puget Sound",
ifelse(stock_code=='GAD', "Hood Canal",
ifelse(stock_code=='ELW', "Juan de Fuca",
ifelse(stock_code=='HOK'|stock_code=='QUE'|stock_code=='SOO', "North Washington Coast",
ifelse(stock_code=='LRH'|stock_code=='CWF'|stock_code=='LRW'|stock_code=='WSH'|stock_code=='SPR', "Lower Columbia River",
ifelse(stock_code=='HAN'|stock_code=='SMK'|stock_code=='SUM'|stock_code=='URB', "Upper Columbia River",
ifelse(stock_code=='LYF'|stock_code=='LYY', "Snake River",
ifelse(stock_code=='SRH', "North Oregon Coast",
ifelse(stock_code=='ELK', "Mid Oregon Coast",1))))))))))))))))))
library(here)
library(dplyr)
library(tidyverse)
library(rerddapXtracto)
# Coastal ocean subregion 1: Puget Sound
poly1 <- read_csv(here("polygons_lat_lon", "poly1_coord.csv"))
# Coastal ocean subregion 1: Puget Sound
poly1 <- read_csv(here("polygons_lat_lon", "poly1_coord.csv"))
# Coastal ocean subregion 1: Puget Sound
poly1 <- read_csv(here("polygons_lat_lon", "poly1_coord.csv"))
# Coastal ocean subregion 2: WA Coast & Columbia R
poly2 <- read_csv(here("polygons_lat_lon", "poly2_coord.csv"))
# Coastal ocean subregion 1: Puget Sound
poly1 <- read_csv(here("polygons_lat_lon", "poly1_coord.csv"))
# Coastal ocean subregion 2: WA Coast & Columbia R
poly2 <- read_csv(here("polygons_lat_lon", "poly2_coord.csv"))
# Coastal ocean subregion 3: N and Central OR Coast
poly3 <- read_csv(here("polygons_lat_lon", "poly3_coord.csv"))
# Coastal ocean subregion 4: S OR and N CA Coast
poly4 <- read_csv(here("polygons_lat_lon", "poly4_coord.csv"))
# Coastal ocean subregion 5: Mendocino Coast and San Fran Coast
poly5 <- read_csv(here("polygons_lat_lon", "poly5_coord.csv"))
# NOAA ERSSTv5 (in situ only), 2°, Global, Monthly, 1854-present
dataInfo <- rerddap::info('nceiErsstv5')
tpos<-c('1854-01-01','2023-11-15')
# Coastal ocean subregion 1
ypos<-(poly1[,2])       # lat
xpos<-(poly1[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly1 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
install.packages("rerddap")
library(here)
library(dplyr)
library(tidyverse)
library(rerddapXtracto)
library(rerddap)
# Coastal ocean subregion 1: Puget Sound
poly1 <- read_csv(here("polygons_lat_lon", "poly1_coord.csv"))
# Coastal ocean subregion 2: WA Coast & Columbia R
poly2 <- read_csv(here("polygons_lat_lon", "poly2_coord.csv"))
# Coastal ocean subregion 3: N and Central OR Coast
poly3 <- read_csv(here("polygons_lat_lon", "poly3_coord.csv"))
# Coastal ocean subregion 4: S OR and N CA Coast
poly4 <- read_csv(here("polygons_lat_lon", "poly4_coord.csv"))
# Coastal ocean subregion 5: Mendocino Coast and San Fran Coast
poly5 <- read_csv(here("polygons_lat_lon", "poly5_coord.csv"))
# NOAA ERSSTv5 (in situ only), 2°, Global, Monthly, 1854-present
dataInfo <- rerddap::info('nceiErsstv5')
tpos<-c('1854-01-01','2023-11-15')
# Coastal ocean subregion 1
ypos<-(poly1[,2])       # lat
xpos<-(poly1[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly1 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
install.packages("rerddapXtracto")
library(rerddapXtracto)
# Coastal ocean subregion 1: Puget Sound
poly1 <- read_csv(here("polygons_lat_lon", "poly1_coord.csv"))
# Coastal ocean subregion 2: WA Coast & Columbia R
poly2 <- read_csv(here("polygons_lat_lon", "poly2_coord.csv"))
# Coastal ocean subregion 3: N and Central OR Coast
poly3 <- read_csv(here("polygons_lat_lon", "poly3_coord.csv"))
# Coastal ocean subregion 4: S OR and N CA Coast
poly4 <- read_csv(here("polygons_lat_lon", "poly4_coord.csv"))
# Coastal ocean subregion 5: Mendocino Coast and San Fran Coast
poly5 <- read_csv(here("polygons_lat_lon", "poly5_coord.csv"))
# NOAA ERSSTv5 (in situ only), 2°, Global, Monthly, 1854-present
dataInfo <- rerddap::info('nceiErsstv5')
tpos<-c('1854-01-01','2023-11-15')
# Coastal ocean subregion 1
ypos<-(poly1[,2])       # lat
xpos<-(poly1[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly1 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly1_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly1$time, format="%Y")),
month = as.numeric(format(ERSST_poly1$time, format="%m")),
sst = apply(ERSST_poly1$sst, 4, mean, na.rm = TRUE) )
# Coastal ocean subregion 2
ypos<-(poly2[,2])       # lat
xpos<-(poly2[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly2 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly2_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly2$time, format="%Y")),
month = as.numeric(format(ERSST_poly2$time, format="%m")),
sst = apply(ERSST_poly2$sst, 4, mean, na.rm = TRUE) )
# Coastal ocean subregion 3
ypos<-(poly3[,2])       # lat
xpos<-(poly3[,1]) +360  # lon + 360
zpos<-0                 # depth
# NOAA ERSSTv5 (in situ only), 2°, Global, Monthly, 1854-present
dataInfo <- rerddap::info('nceiErsstv5')
tpos<-c('1854-01-01','2023-11-15')
# Coastal ocean subregion 1
ypos<-(poly1[,2])       # lat
xpos<-(poly1[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly1 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly1
ERSST_poly1_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly1$time, format="%Y")),
month = as.numeric(format(ERSST_poly1$time, format="%m")),
sst = apply(ERSST_poly1$sst, 4, mean, na.rm = TRUE) )
# Coastal ocean subregion 2
ypos<-(poly2[,2])       # lat
xpos<-(poly2[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly2 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly2_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly2$time, format="%Y")),
month = as.numeric(format(ERSST_poly2$time, format="%m")),
sst = apply(ERSST_poly2$sst, 4, mean, na.rm = TRUE) )
# Coastal ocean subregion 3
ypos<-(poly3[,2])       # lat
xpos<-(poly3[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly3 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly3_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly3$time, format="%Y")),
month = as.numeric(format(ERSST_poly3$time, format="%m")),
sst = apply(ERSST_poly3$sst, 4, mean, na.rm = TRUE) )
# Coastal ocean subregion 4
ypos<-(poly4[,2])       # lat
xpos<-(poly4[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly4 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly4_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly4$time, format="%Y")),
month = as.numeric(format(ERSST_poly4$time, format="%m")),
sst = apply(ERSST_poly4$sst, 4, mean, na.rm = TRUE) )
# Coastal ocean subregion 5
ypos<-(poly5[,2])       # lat
xpos<-(poly5[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly5 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly5_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly5$time, format="%Y")),
month = as.numeric(format(ERSST_poly5$time, format="%m")),
sst = apply(ERSST_poly5$sst, 4, mean, na.rm = TRUE) )
# Multi-scale Ultra-high Resolution (MUR) SST Analysis fv04.1, Global, 0.01°, 2002-present, Monthly
dataInfo <- rerddap::info('jplMURSST41mday')
tpos<-c('2003-01-01','2023-12-16')
# Coastal ocean subregion 1
ypos<-(poly1[,2])    # lat
xpos<-(poly1[,1])    # lon
SST_MUR_poly1 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly1_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly1$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly1$time, format="%m")),
sst = apply(SST_MUR_poly1$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 2
ypos<-(poly2[,2])    # lat
xpos<-(poly2[,1])    # lon
SST_MUR_poly2 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly2_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly2$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly2$time, format="%m")),
sst = apply(SST_MUR_poly2$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 3
ypos<-(poly3[,2])    # lat
xpos<-(poly3[,1])    # lon
SST_MUR_poly3 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly3_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly3$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly3$time, format="%m")),
sst = apply(SST_MUR_poly3$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 4
ypos<-(poly4[,2])    # lat
xpos<-(poly4[,1])    # lon
SST_MUR_poly4 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly4_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly4$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly4$time, format="%m")),
sst = apply(SST_MUR_poly4$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 5
ypos<-(poly5[,2])    # lat
xpos<-(poly5[,1])    # lon
SST_MUR_poly5 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly5_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly5$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly5$time, format="%m")),
sst = apply(SST_MUR_poly5$sst, 3, mean, na.rm = TRUE) )
SST_MUR_poly5_yr_mo_df
ERSST_poly2_yr_mo_df
# Coastal ocean subregion 5
ypos<-(poly5[,2])       # lat
xpos<-(poly5[,1]) +360  # lon + 360
zpos<-0                 # depth
ERSST_poly5 <- rxtracto_3D(dataInfo, parameter='sst', xcoord=xpos, ycoord=ypos, zcoord=zpos, tcoord=tpos, # sst data in array of [Lon, Lat, Time]
xName='longitude', yName='latitude', zName='depth', tName='time',
verbose=TRUE)
ERSST_poly5_yr_mo_df
ERSST_poly5_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly5$time, format="%Y")),
month = as.numeric(format(ERSST_poly5$time, format="%m")),
sst = apply(ERSST_poly5$sst, 4, mean, na.rm = TRUE) )%>%
mutate(ecoregion=5)
ERSST_poly5_yr_mo_df <- data.frame(year = as.numeric(format(ERSST_poly5$time, format="%Y")),
month = as.numeric(format(ERSST_poly5$time, format="%m")),
sst = apply(ERSST_poly5$sst, 4, mean, na.rm = TRUE) )%>%
add_column(ecoregion=5)
data.frame(year = as.numeric(format(ERSST_poly5$time, format="%Y")),
month = as.numeric(format(ERSST_poly5$time, format="%m")),
sst = apply(ERSST_poly5$sst, 4, mean, na.rm = TRUE) )
ERSST_poly5_yr_mo_df
ERSST_poly5_yr_mo_df%>%add_column(ecoregion=5)
ERSST_poly5_yr_mo_df <-ERSST_poly5_yr_mo_df%>%add_column(ecoregion=5)
ERSST_poly4_yr_mo_df <-ERSST_poly4_yr_mo_df%>%add_column(ecoregion=4)
ERSST_poly3_yr_mo_df <-ERSST_poly3_yr_mo_df%>%add_column(ecoregion=3)
ERSST_poly2_yr_mo_df <-ERSST_poly2_yr_mo_df%>%add_column(ecoregion=2)
ERSST_poly2_yr_mo_df
ERSST_poly1_yr_mo_df <-ERSST_poly1_yr_mo_df%>%add_column(ecoregion=1)
ERSST_poly1_yr_mo_df
ERSST_poly<-ERSST_poly1_yr_mo_df%>%add_row(ERSST_poly2_yr_mo_df,
ERSST_poly3_yr_mo_df,
ERSST_poly4_yr_mo_df,
ERSST_poly5_yr_mo_df)
ERSST_poly1_yr_mo_df%>%add_row(ERSST_poly2_yr_mo_df)
ERSST_poly<-ERSST_poly1_yr_mo_df%>%add_row(ERSST_poly2_yr_mo_df)%>%
add_row(ERSST_poly3_yr_mo_df)%>%
add_row(ERSST_poly4_yr_mo_df)%>%
add_row(ERSST_poly5_yr_mo_df)
ERSST_poly
# Multi-scale Ultra-high Resolution (MUR) SST Analysis fv04.1, Global, 0.01°, 2002-present, Monthly
dataInfo <- rerddap::info('jplMURSST41mday')
tpos<-c('2003-01-01','2023-12-16')
# Coastal ocean subregion 1
ypos<-(poly1[,2])    # lat
xpos<-(poly1[,1])    # lon
SST_MUR_poly1 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly1_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly1$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly1$time, format="%m")),
sst = apply(SST_MUR_poly1$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 2
ypos<-(poly2[,2])    # lat
xpos<-(poly2[,1])    # lon
SST_MUR_poly2 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly2_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly2$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly2$time, format="%m")),
sst = apply(SST_MUR_poly2$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 3
ypos<-(poly3[,2])    # lat
xpos<-(poly3[,1])    # lon
SST_MUR_poly3 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly3_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly3$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly3$time, format="%m")),
sst = apply(SST_MUR_poly3$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 4
ypos<-(poly4[,2])    # lat
xpos<-(poly4[,1])    # lon
SST_MUR_poly4 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly4_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly4$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly4$time, format="%m")),
sst = apply(SST_MUR_poly4$sst, 3, mean, na.rm = TRUE) )
# Coastal ocean subregion 5
ypos<-(poly5[,2])    # lat
xpos<-(poly5[,1])    # lon
SST_MUR_poly5 <- rxtractogon(dataInfo, xcoord=xpos, ycoord=ypos, tcoord=tpos, parameter='sst') # sst data in array of [Lon, Lat, Time]
SST_MUR_poly5_yr_mo_df <- data.frame(year = as.numeric(format(SST_MUR_poly5$time, format="%Y")),
month = as.numeric(format(SST_MUR_poly5$time, format="%m")),
sst = apply(SST_MUR_poly5$sst, 3, mean, na.rm = TRUE) )
SST_MUR_poly1_yr_mo_df <-SST_MUR_poly1_yr_mo_df%>%add_column(ecoregion=5)
SST_MUR_poly2_yr_mo_df <-SST_MUR_poly2_yr_mo_df%>%add_column(ecoregion=5)
SST_MUR_poly3_yr_mo_df <-SST_MUR_poly3_yr_mo_df%>%add_column(ecoregion=5)
SST_MUR_poly4_yr_mo_df <-SST_MUR_poly4_yr_mo_df%>%add_column(ecoregion=5)
SST_MUR_poly5_yr_mo_df <-SST_MUR_poly5_yr_mo_df%>%add_column(ecoregion=5)
SST_MUR_poly2_yr_mo_df
SST_MUR_poly<-SST_MUR_poly1_yr_mo_df%>%add_row(SST_MUR_poly2_yr_mo_df)%>%
add_row(SST_MUR_poly3_yr_mo_df)%>%
add_row(SST_MUR_poly4_yr_mo_df)%>%
add_row(SST_MUR_poly5_yr_mo_df)
saveRDS(data/emvironment/SST/SST_MUR_poly, file = "SST_MUR_poly.rds")
saveRDS(data/environment/SST/SST_MUR_poly, file = "SST_MUR_poly.rds")
saveRDS(SST_MUR_poly, file = "data/environment/SST/SST_MUR_poly.rds")
saveRDS(ERSST_poly, file = "data/environment/SST/ERSST_poly.rds")
dat<- readRDS("data/all_juvenile_indices.rds")
dat<- read.csv("data/salmon/MatRate_Survival_up to CY 2021_new.csv")
Indicator_ID<-data.frame(stock_code=unique(dat$stock_code))
Indicator_ID%>%mutate(stock_name=ifelse(stock_code=='ATN', "Atnarko",
ifelse(stock_code=='BQR', "Big Qualicum River Fall",
ifelse(stock_code=='CHI', "Chilliwack River Fall",
ifelse(stock_code=='COW', "Cowichan River Fall",
ifelse(stock_code=='CWF', "Cowlitz Fall Tule",
ifelse(stock_code=='ELK', "Elk River",
ifelse(stock_code=='ELW', "Elwha River",
ifelse(stock_code=='GAD', "George Adams Fall Fingerling",
ifelse(stock_code=='GRN', "Green River Fingerling",
ifelse(stock_code=='HAN', "Hanford Wild Brights",
ifelse(stock_code=='HAR', "Harrison River",
ifelse(stock_code=='HOK', "Hoko Fall Fingerling",
ifelse(stock_code=='KLM', "Kitsumkalum River Summer",
ifelse(stock_code=='KLY', "Kitsumkalum Yearling",
ifelse(stock_code=='LRH', "Columbia Lower River Hatchery",
ifelse(stock_code=='LRW', "Lewis River Wild",
ifelse(stock_code=='LYF', "Lyons Ferry Fingerling",
ifelse(stock_code=='LYY', "Lyons Ferry Yearling",
ifelse(stock_code=='MSH', "Middle Shuswap",
ifelse(stock_code=='NIC', "Nicola",
ifelse(stock_code=='NIS', "Nisqually Fall Fingerling",
ifelse(stock_code=='NSA', "Northern Southeast Alaska",
ifelse(stock_code=='NSF', "Nooksack Spring Fingerling",
ifelse(stock_code=='PHI', "Phillips River Fall",
ifelse(stock_code=='PPS', "Puntledge River Summer",
ifelse(stock_code=='QUE', "Queets Fall Fingerling",
ifelse(stock_code=='QUI', "Quinsam River Fall ",
ifelse(stock_code=='RBT', "Robertson Creek Fall",
ifelse(stock_code=='SAM', "Samish Fall Fingerling",
ifelse(stock_code=='SHU', "Lower Shuswap River Summer",
ifelse(stock_code=='SKF', "Skagit Spring Fingerling",
ifelse(stock_code=='SKY', "Skykomish Fall Fingerling",
ifelse(stock_code=='SMK', "Similkameen Summer Yearling",
ifelse(stock_code=='SOO', "Tsoo-Yess Fall Fingerling",
ifelse(stock_code=='SPR', "Spring Creek Tule",
ifelse(stock_code=='SPS', "South Puget Sound Fall Fingerling",
ifelse(stock_code=='SRH', "Salmon River",
ifelse(stock_code=='SSA', "Southern SEAK Spring",
ifelse(stock_code=='SSF', "Skagit Summer Fingerling",
ifelse(stock_code=='STL', "Stillaguamish Fall Fingerling² ",
ifelse(stock_code=='SUM', "Columbia River Summers",
ifelse(stock_code=='URB', "Columbia Upriver Bright",
ifelse(stock_code=='WSH', "Willamette Spring",1))))))))))))))))))))))))))))))))))))))))))))
library(dplyr)
library(reshape2)
library(bayesdfa)
library(MCMCvis)
library(ggplot2)
library(stringr)
library(ggpubr)
library(tidyverse)
library(dplyr)
dat<- readRDS("data/all_juvenile_indices.rds")
dat<- read.csv("data/salmon/MatRate_Survival_up to CY 2021_new.csv")
Indicator_ID<-data.frame(stock_code=unique(dat$stock_code))
Indicator_ID%>%mutate(stock_name=ifelse(stock_code=='ATN', "Atnarko",
ifelse(stock_code=='BQR', "Big Qualicum River Fall",
ifelse(stock_code=='CHI', "Chilliwack River Fall",
ifelse(stock_code=='COW', "Cowichan River Fall",
ifelse(stock_code=='CWF', "Cowlitz Fall Tule",
ifelse(stock_code=='ELK', "Elk River",
ifelse(stock_code=='ELW', "Elwha River",
ifelse(stock_code=='GAD', "George Adams Fall Fingerling",
ifelse(stock_code=='GRN', "Green River Fingerling",
ifelse(stock_code=='HAN', "Hanford Wild Brights",
ifelse(stock_code=='HAR', "Harrison River",
ifelse(stock_code=='HOK', "Hoko Fall Fingerling",
ifelse(stock_code=='KLM', "Kitsumkalum River Summer",
ifelse(stock_code=='KLY', "Kitsumkalum Yearling",
ifelse(stock_code=='LRH', "Columbia Lower River Hatchery",
ifelse(stock_code=='LRW', "Lewis River Wild",
ifelse(stock_code=='LYF', "Lyons Ferry Fingerling",
ifelse(stock_code=='LYY', "Lyons Ferry Yearling",
ifelse(stock_code=='MSH', "Middle Shuswap",
ifelse(stock_code=='NIC', "Nicola",
ifelse(stock_code=='NIS', "Nisqually Fall Fingerling",
ifelse(stock_code=='NSA', "Northern Southeast Alaska",
ifelse(stock_code=='NSF', "Nooksack Spring Fingerling",
ifelse(stock_code=='PHI', "Phillips River Fall",
ifelse(stock_code=='PPS', "Puntledge River Summer",
ifelse(stock_code=='QUE', "Queets Fall Fingerling",
ifelse(stock_code=='QUI', "Quinsam River Fall ",
ifelse(stock_code=='RBT', "Robertson Creek Fall",
ifelse(stock_code=='SAM', "Samish Fall Fingerling",
ifelse(stock_code=='SHU', "Lower Shuswap River Summer",
ifelse(stock_code=='SKF', "Skagit Spring Fingerling",
ifelse(stock_code=='SKY', "Skykomish Fall Fingerling",
ifelse(stock_code=='SMK', "Similkameen Summer Yearling",
ifelse(stock_code=='SOO', "Tsoo-Yess Fall Fingerling",
ifelse(stock_code=='SPR', "Spring Creek Tule",
ifelse(stock_code=='SPS', "South Puget Sound Fall Fingerling",
ifelse(stock_code=='SRH', "Salmon River",
ifelse(stock_code=='SSA', "Southern SEAK Spring",
ifelse(stock_code=='SSF', "Skagit Summer Fingerling",
ifelse(stock_code=='STL', "Stillaguamish Fall Fingerling² ",
ifelse(stock_code=='SUM', "Columbia River Summers",
ifelse(stock_code=='URB', "Columbia Upriver Bright",
ifelse(stock_code=='WSH', "Willamette Spring",1))))))))))))))))))))))))))))))))))))))))))))
Indicator_ID%>%mutate(area=ifelse(stock_code=='NSA'|stock_code=='SSA'|stock_code=='CHK'|stock_code=='UNU', "Southeast Alaska",
ifelse(stock_code=='TST', "Transboundary Rivers",
ifelse(stock_code=='ATN'|stock_code=='KLM'|stock_code=='KLY', "North/Central BC",
ifelse(stock_code=='RBT', "WCVI",
ifelse(stock_code=='QUI'|stock_code=='PHI'|stock_code=='PPS'|stock_code=='BQR'|stock_code=='COW', "Strait of Georgia",
ifelse(stock_code=='HAR'|stock_code=='CHI'|stock_code=='CKO'|stock_code=='NIC'|stock_code=='SHU'|stock_code=='MSH', "Fraser River",
ifelse(stock_code=='NSF'|stock_code=='SAM'|stock_code=='SSF'|stock_code=='SKF', "North Puget Sound",
ifelse(stock_code=='STL'|stock_code=='SKY', "Central Puget Sound",
ifelse(stock_code=='NIS'|stock_code=='SPS'|stock_code=='GRN', "South Puget Sound",
ifelse(stock_code=='GAD', "Hood Canal",
ifelse(stock_code=='ELW', "Juan de Fuca",
ifelse(stock_code=='HOK'|stock_code=='QUE'|stock_code=='SOO', "North Washington Coast",
ifelse(stock_code=='LRH'|stock_code=='CWF'|stock_code=='LRW'|stock_code=='WSH'|stock_code=='SPR', "Lower Columbia River",
ifelse(stock_code=='HAN'|stock_code=='SMK'|stock_code=='SUM'|stock_code=='URB', "Upper Columbia River",
ifelse(stock_code=='LYF'|stock_code=='LYY', "Snake River",
ifelse(stock_code=='SRH', "North Oregon Coast",
ifelse(stock_code=='ELK', "Mid Oregon Coast",1))))))))))))))))))
read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_45N.csv')
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_38N.csv')%>%add_column(location='38'))%>%
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_35N.csv')%>%add_column(location='35'))
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_38N.csv')%>%add_column(location='38N'))%>%
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_33N.csv')%>%add_column(location='33N'))
Beuti%>%
add_column('Year'=as.numeric(format(as.Date(Beuti$time),"%Y")))%>%
add_column('Month'=as.numeric(format(as.Date(Beuti$time),"%m")))%>%
add_column("Day"=as.numeric(format(as.Date(Beuti$time),"%d")))
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_38N.csv')%>%add_column(location='38N'))%>%
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_33N.csv')%>%add_column(location='33N'))
Beuti%>%
add_column('Year'=as.numeric(format(as.Date(Beuti$time),"%Y")))%>%
add_column('Month'=as.numeric(format(as.Date(Beuti$time),"%m")))%>%
add_column("Day"=as.numeric(format(as.Date(Beuti$time),"%d")))
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_38N.csv')%>%add_column(location='38N'))%>%
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_33N.csv')%>%add_column(location='33N'))
Beuti%>%
add_column('Year'=as.numeric(format(as.Date(Beuti$time),"%Y")))%>%
add_column('Month'=as.numeric(format(as.Date(Beuti$time),"%m")))%>%
add_column("Day"=as.numeric(format(as.Date(Beuti$time),"%d")))
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_38N.csv')%>%add_column(location='38N'))%>%
bind_rows(read.csv('data/Environment/CUTI_BEUTI/cciea_OC_BEUTI_33N.csv')%>%add_column(location='33N'))
