stock_name+
s(Beuti_tumi_scale, by=calendar_year, k=8)+
s(calendar_year, by=region, k=6),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
t4<-brm(Survival_scale ~ s(calendar_year, k=6) +
stock_name+
# s(Beuti_tumi_scale, by=calendar_year, k=8)+
s(calendar_year, by=region, k=6),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
t4<-brm(Survival_scale ~ s(calendar_year, k=6) +
stock_name+
# s(Beuti_tumi_scale, by=calendar_year, k=8)+
s(calendar_year, by=region, k=6),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
t4<-brm(Survival_scale ~ s(calendar_year, k=6) +
stock_name+
s(Beuti_tumi_scale, by=calendar_year, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
loo(t3)
t1<-brm(log(Marine.Survival) ~ stock_name+s(calendar_year, k=6),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(t1)
conditional_effects(t1)
bayes_R2(t1)
loo(t1)
t2<-brm(Survival_scale ~ stock_name+s(Beuti_tumi_scale, k=3),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(t2)
conditional_effects(t2)
bayes_R2(t2)
loo(t2)
loo(t1)
t3<-brm(Survival_scale ~ stock_name+s(calendar_year, k=6) +
s(Beuti_tumi_scale, by=calendar_year, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(t3)
stock_name+
s(Beuti_tumi_scale, by=region, k=8),
bayes_R2(t3)
loo(t3)
max_tree<-14
adapt_d <- 0.99
iterations<-4000
t3<-brm(Survival_scale ~ stock_name+s(calendar_year, k=6) +
s(Beuti_tumi_scale, by=calendar_year, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, cores=3,chains = 3)
conditional_effects(t3)
loo(t3)
conditional_effects(t4)
t4<-brm(Survival_scale ~
s(calendar_year, by=stock_name k=6)+
t4<-brm(Survival_scale ~
s(calendar_year, by=stock_name, k=6)+
s(Beuti_tumi_scale, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(t4)
t4<-brm(Survival_scale ~
s(calendar_year, by=stock_name, k=6)+
s(Beuti_tumi_scale, k=3),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
bayes_R2(t4)
loo(t4)
t4<-brm(Survival_scale ~
s(calendar_year, by=stock_name, k=6)+
s(Beuti_tumi_scale, k=3),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(t4)
bayes_R2(t4)
loo(t4)
t4<-brm(Survival_scale ~
s(calendar_year, by=stock_name, k=6),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(t4)
loo(t4)
bayes_R2(t4)
conditional_effects(t4)
data=SalmonSurvCUI,
SalmonSurvCUI
####  No Trends through Time ####
R<-brm(Survival_scale ~ RunType,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(R)
bayes_R2(R)
loo(R)
S<-brm(Survival_scale ~ stock_name,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
iterations
iterations<-5000
warmup=<-1000
warmup<-1000
S<-brm(Survival_scale ~ stock_name,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, armup=warmup.,ores=3,chains = 3)
S<-brm(Survival_scale ~ stock_name,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, armup=warmup,ores=3,chains = 3)
S<-brm(Survival_scale ~ stock_name,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, warmup=warmup,ores=3,chains = 3)
S<-brm(Survival_scale ~ stock_name,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, warmup=warmup,cores=3,chains = 3)
S<-brm(Survival_scale ~ stock_name,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(S)
bayes_R2(S)
loo(S)
Reg<-brm(Survival_scale ~ Region,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
Reg<-brm(Survival_scale ~ region,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(t3)
Reg<-brm(Survival_scale ~ region,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(Reg)
bayes_R2(Reg)
loo(Reg)
##### Mean Differences; Single trend #####
tR<-brm(Survival_scale ~ RunType+
s(calendar_year, k=6),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tR)
bayes_R2(tR)
loo(tR)
##### Mean Differences; Single trend #####
tR<-brm(Survival_scale ~ RunType+
s(calendar_year, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
conditional_effects(tR)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
bayes_R2(tS)
loo(tS)
loo(tR)
tReg<-brm(Survival_scale ~ region+
s(calendar_year, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tReg)
bayes_R2(tReg)
loo(tReg)
t<-brm(Survival_scale ~
s(calendar_year, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(t)
bayes_R2(t)
loo(t)
##### Mean Differences; Single trend #####
tRs<-brm(Survival_scale ~
s(calendar_year,by= RunType, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tRs)
bayes_R2(tRs)
loo(tRs)
tSs<-brm(Survival_scale ~
s(calendar_year, by=stock_name, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tSs)
tRegs<-brm(Survival_scale ~
s(calendar_year,by = region, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tRegs)
bayes_R2(tRs)
loo(tRs)
bayes_R2(tSs)
loo(tSs)
loo(tRs)
bayes_R2(tSs)
loo(tSs)
bayes_R2(tS)
loo(tS)
loo(S)
loo(tRs)
loo(tSs)
loo(tS)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tC)
bayes_R2(tC)
loo(tC)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = cor_ar(~ year, p = 1) ),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
library(brms)
library(ggplot2)
library(dplyr)
library(MARSS)
library(ggplot2)
library(broom.mixed)
library(MCMCvis)
library(tidyverse)
library(dplyr)
library(mgcv)
library(MASS)
library(stringr)
library(gamm4)
library(tidyr)
library(ggthemes)
SalmonSurv <- read.csv("data/Salmon/Survival_combined.csv")
SalmonSurvCUI<- SalmonSurv%>% #grabbing a single stock, I chose at random
group_by(stock_name)%>%
mutate(Survival_scale=log(Marine.Survival))%>% #making sure data are normalized
ungroup()%>%
rename(year=brood_year)%>%
as.data.frame()%>%
filter(calendar_year>=1986 & calendar_year<=2022&stock_name!='NA')
unique(SalmonSurvCUI$stock_name)
max_tree<-14
adapt_d <- 0.99
iterations<-5000
warmup<-1000
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = cor_ar(~ year, p = 1) ),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor = cor_ar(~ calendar_year, p = 1) ,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = cor_ar(~ calendar_year, p = 1) ),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = cor_ar(p = 1)),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = arma(p = 1)),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor = cor_ar(~ calendar_year, p = 1) ,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor = cor_ar(~ calendar_year, p = 1) ),
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = cor_ar(~ calendar_year, p = 1) ),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = ar(~ calendar_year, p = 1) ),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor = ar( p = 1) ),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8)+autocor = ~cor_ar(~ year, p = 1),,
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8)+autocor ~cor_ar(~ year, p = 1),,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8)+autocor =cor_ar(~ calendar_year, p = 1),,
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =cor_ar(~ calendar_year, p = 1),,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
?brmsformula
?cor_brms
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =ar(~ calendar_year, p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8)+autocor =ar(~calendar_year, p = 1),
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor =ar(~calendar_year, p = 1)),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =ar(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =ar(~calendar_year, p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =cor_ar(formula = ~1, p = 1, cov = FALSE)
data=SalmonSurvCUI,
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =cor_ar(formula = ~1, p = 1, cov = FALSE),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =cor_ar(formula = ~calendar_year, p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8,autocor =cor_ar(formula = ~calendar_year, p = 1)),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8),autocor =cor_ar(formula = ~1, p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8)+arma(p = 1, q = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tC<-brm(Survival_scale ~ stock_name+
s(calendar_year,by = region, k=8)+arma(time=calendar_year,p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
t<-brm(Survival_scale ~
s(calendar_year, k=8)+arma(time=calendar_year,p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
t<-brm(Survival_scale ~
s(calendar_year, k=8),autocor = ~ arma(time=calendar_year,p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
t<-brm(Survival_scale ~
s(calendar_year, k=8)+arma(time=calendar_year,p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
t<-brm(Survival_scale ~
s(calendar_year, k=8)+arma(time=Survival_scale|calendar_year,p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
t<-brm(Survival_scale ~
s(calendar_year, k=8)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(t)
bayes_R2(t)
loo(t)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=6)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
bayes_R2(tS)
loo(tS)
R<-brm(Survival_scale ~ RunType,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = 3000, cores=3,chains = 3)
conditional_effects(R)
bayes_R2(R)
loo(R)
S<-brm(Survival_scale ~ stock_name,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(S)
bayes_R2(S)
loo(S)
Reg<-brm(Survival_scale ~ region,
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(Reg)
bayes_R2(Reg)
loo(Reg)
##### Mean Differences; Single trend #####
tR<-brm(Survival_scale ~ RunType+
s(calendar_year, k=8)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tR)
loo(tR)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
loo(tS)
tReg<-brm(Survival_scale ~ region+
s(calendar_year, k=8)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=max_tree),
iter = iterations, warmup=warmup,cores=3,chains = 3)
bayes_R2(tS)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8)+arma(p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=15),
iter = iterations, warmup=warmup,cores=3,chains = 3)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8)+arma(time=calendar_year,gr=stock_name, p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=15),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
bayes_R2(tS)
loo(tS)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8)+
arma(time=calendar_year, cov = TRUE,gr=stock_name, p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=15),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
bayes_R2(tS)
loo(tS)
tS<-brm(Survival_scale ~ stock_name+
s(calendar_year, k=8),
# arma(time=calendar_year, cov = TRUE,gr=stock_name, p = 1),
data=SalmonSurvCUI,
control=list(adapt_delta=adapt_d,max_treedepth=15),
iter = iterations, warmup=warmup,cores=3,chains = 3)
conditional_effects(tS)
bayes_R2(tS)
loo(tS)
